# Bejeweled #
## 【需求规格说明】 ##
- 题号：4
- 题目：


在一个 10x10 迷阵中随机分布着不同颜色（红、绿、蓝、紫、黄）的宝石，通过交换相邻的 两块宝石，使 3 个同一颜色的宝石连在一起，以消去它们。消去之后，空出的格子上方的宝石向 下移动，然后迷阵每列最上方空出的格子再采用随机方法填充。

- 要求： 

（1）通过输入行列号和方向来交换宝石。

（2）界面采用表格+颜色对应文字的方式输出，也可以自行查阅在命令行界面下如何进行彩 色文本编程。 

（3）多于 3 个的宝石也可以连锁消去；

（4）游戏初始时随机被连在一起的 3 个及更多宝石也要自动消去。

（5）因前一步削去造成的因迷阵格局变化而连在一起的 3 个及更多宝石也要自动消去。

（6）思路与上题相似，用类来实现该游戏，建立 CGame 类，提供游戏初始化、削去、填充、 输出迷阵等函数；用户输入 q 退出游戏。
进阶加分：自阐述创新点。




- 问题分析：
首先，为存储游戏地图选择适合的容器。然后，注意游戏规则三个连在一起消去即横竖三个连在一起为开始消除条件，然后连锁消除，即与着三个方块在横竖方向相通的区域消去。其次，解决每次消除后方块下落。最后，写出便于用户操作与观察的友好界面。

## 【算法设计】 ##
- 设计思想：
首先，为了方便游戏删除后下落所以选择可以使用有erase的vector容器来存储地图。然后，游戏规则三个连载一起消除可以直接写四个循环语句，分别向上下左右四个方向查找相同的方块，然后对上下相加，左右相加，找是否存在三个及以上的连续方块，如若存在则采用深度搜索（DFS）查找相同方块并标记，最后一起删除，这样可以解决方块下落后位置改变无法继续查找。其次，方块下落可以用vector数组来存储每一列，删除某个方块直接erase对应位置，随后直接push_back一个随机方块即可。最后，使用Windows32API纯API编程写的可点击交互界面，并设置重新开始按钮。
 
- 设计表示：

## 【调试报告】 ##


- 问题：
描述问题：时间长了之后游戏会刷新异常
解决方案：由于GDI对象泄露，所以每次设置画笔使用之后删除画笔


- 创新：

	
	1.Win32API+GDI 使界面人性化，操作简单化
	
	2.DFS搜索，当找到横竖相同三个时，会消除与三个方块连续的方块


## 【附录】 ##


- 源程序清单：

	4_窗口版本.cpp     //windows消息循环
	
	CGame.cpp         //游戏类实现
	
	CGame.h           //游戏类声明
	
	define.h            //常量定义（便于修改界面）

- 测试数据及运行结果：


